---
index: 2
---

# 依赖节点

开发中, 我们常常诟病 `层层包` 的开发范式, 但前端很多时候又不得不为了样式或功能多包一层 `div.warpper`, 例如:

```html
<div class="button-warpper">
  <button class="hover-scale">
    悬浮变大按钮
  </button>
</div>
```

当 `button` 悬浮变大时, 会影响流中的其他元素, 因此, 不得不在外面包一层 `div.button-warpper`.

`div.button-warpper` 无任何语义化含义, 只有依赖于内部的 `button` 才能实现功能, 且只有 `button` 一个直接子节点, 这样的节点称为 `依赖节点`.

`preezid` 中可以将依赖节点直接作为一种属性, 插入到真正的节点中, 例如:

```lts
button
  .class("hover-scaler")
  .node("warpper") {
    div.class("button-warpper")
  } {
    "悬浮变大按钮"
  }
```

或使用简写属性 `.*warpper {}`:

```lts
button
  .class("hover-scaler")
  .*warpper {
    div.class("button-warpper")
  } {
    "悬浮变大按钮"
  }
```

下面讲解不同类型的依赖节点:

## `warpper` 包裹节点

`warpper` 依赖节点用于包裹当前节点, 使其具备某些样式或功能. 例如上面的 `button` 悬浮变大功能, 就需要一个 `warpper` 节点来实现.

`warpper` 节点将编译成一个直接包裹在外面的节点, 属性保持不变, 多个 `warpper` 节点将依次包裹在外层, 例如:

```lts
load {
  div.node("warpper") {
    div.class("outer-warpper")
    div.class("middle-warpper")
    div.class("inner-warpper")
  } {
    "inner DOM"
  }

  // 或使用简写形式
  div.*warpper {
    div.class("outer-warpper")
    div.class("middle-warpper")
    div.class("inner-warpper")
  } {
    "inner DOM"
  }
}
```

它将编译成如下结构:

```html
<div class="outer-warpper">
  <div class="middle-warpper">
    <div class="inner-warpper">
      <div>
        inner DOM
      </div>
    </div>
  </div>
</div>
```

## `before`, `after` 伪元素节点

`CSS` 中可使用 `::before` 和 `::after` 伪元素来在元素前后插入内容, `preezid` 中也提供了类似的 `before` 和 `after` 依赖节点.

由于 `CSS` 的限制, 因此 `before` 和 `after` 各自最多只能存在一个, 此外, 由于他们是伪元素, 无子节点(但可以有字符串), 直接在 `.node()` 后使用链式追加属性即可.

```lts
load {
  div
    .node("before").style(...) { "before content" }
    .node("after").style(...) { "after content" }
    { "inner DOM" }

  // 或使用简写形式
  div
    .*before.style(...) { "before content" }
    .*after.style(...) { "after content" }
    { "inner DOM" }
}
```

它将编译成如下结构:

```html
<div>
  ::before
  inner DOM
  ::after
</div>
```

## `pivot` 锚点节点

`pivot` 用来做流中插入一个隐形元素, 作为 `absoulute` 定位的锚点使用.

`pivot` 节点不能嵌套, 且一般不包含子节点, 不包含属性, 指名 DOM 类型即可.

```lts
load {
  div.node("pivot) { div }
  { "absoulute DOM" }
  
  // 或使用简写形式
  div.*pivot { div }
  { "absoulute DOM" }
}
```
